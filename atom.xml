<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Catherine&#39;s blog</title>
  
  <subtitle>Knowledge makes humble, ignorance makes proud.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://p2626k.github.io/"/>
  <updated>2020-06-17T00:43:22.331Z</updated>
  <id>https://p2626k.github.io/</id>
  
  <author>
    <name>Catherine Chen</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>AWS-course</title>
    <link href="https://p2626k.github.io/2020/06/17/AWS-course/"/>
    <id>https://p2626k.github.io/2020/06/17/AWS-course/</id>
    <published>2020-06-17T00:41:13.000Z</published>
    <updated>2020-06-17T00:43:22.331Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
      <category term="AWS" scheme="https://p2626k.github.io/categories/AWS/"/>
    
    
  </entry>
  
  <entry>
    <title>OpenSUSE-install</title>
    <link href="https://p2626k.github.io/2020/06/12/OpenSUSE-install/"/>
    <id>https://p2626k.github.io/2020/06/12/OpenSUSE-install/</id>
    <published>2020-06-12T06:34:19.000Z</published>
    <updated>2020-06-17T07:06:26.704Z</updated>
    
    <content type="html"><![CDATA[<p>這篇要介紹在 OpenSUSE 上安裝Nginx、Java、Tomcat，並將前端畫面放置在Nginx，後端放置在Tomcat中，當中碰到小卡關的地方</p><ol><li>安裝軟體時，會有儲存庫缺失問題，需要加入儲存庫</li><li>Tomcat因為Java安裝路徑不對，無法啟動</li><li>同樣的安裝指令安裝起來的Java版本不同</li><li>Nginx如何設置才讀到到畫面</li><li>前端畫面call後端發生CORS問題</li></ol><a id="more"></a> <h1 id="安裝軟體時，會有儲存庫缺失問題，需要加入儲存庫"><a href="#安裝軟體時，會有儲存庫缺失問題，需要加入儲存庫" class="headerlink" title="安裝軟體時，會有儲存庫缺失問題，需要加入儲存庫"></a>安裝軟體時，會有儲存庫缺失問題，需要加入儲存庫</h1><p>SUSE 有專用安裝軟體的套件，zypper &amp; Yast，這裡只使用zypper，zypper安裝指令為 (以Java為例) zypper install java-1_8_0-openjdk</p><p>在安裝前可以先查詢，指令為 zypper search java，搜尋後發現沒有java，這是因為我們的儲存庫 repository 中沒有支援java，我們只要加入即可</p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zypper addrepo https://download.opensuse.org/repositories/Java:Factory/openSUSE_Leap_15.1/Java:Factory.repo</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://software.opensuse.org/download.html?project=Java%3AFactory&package=java-1_8_0-openjdk" target="_blank" rel="noopener">java repository</a></p></blockquote><p>此時使用 zypper search java ，就可以看到java版本供選擇，加入儲存庫後要安裝時又發生一個問題，說有一個giflib套件沒有加入，再加入即可</p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zypper addrepo https://download.opensuse.org/repositories/openSUSE:Leap:15.1/standard/openSUSE:Leap:15.1.repo</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://software.opensuse.org/download/package?package=giflib&project=openSUSE%3ALeap%3A15.1" target="_blank" rel="noopener">giflib repository</a></p></blockquote><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zypper install java-1_8_0-openjdk</span><br></pre></td></tr></table></figure><h1 id="Tomcat因為Java安裝路徑不對，無法啟動"><a href="#Tomcat因為Java安裝路徑不對，無法啟動" class="headerlink" title="Tomcat因為Java安裝路徑不對，無法啟動"></a>Tomcat因為Java安裝路徑不對，無法啟動</h1><blockquote><p>tomcat(source code install, download from <a href="http://ftp.mirror.tw/pub/apache/tomcat/tomcat-9/v9.0.36/bin/apache-tomcat-9.0.36.tar.gz" target="_blank" rel="noopener">http://ftp.mirror.tw/pub/apache/tomcat/tomcat-9/v9.0.36/bin/apache-tomcat-9.0.36.tar.gz</a>)</p></blockquote><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo wget http://ftp.mirror.tw/pub/apache/tomcat/tomcat-9/v9.0.36/bin/apache-tomcat-9.0.36.tar.gz</span><br></pre></td></tr></table></figure><ul><li>將壓縮檔丟到/opt</li><li>解壓縮</li></ul><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tar xvf /opt/apache-tomcat-9* -C /opt/tomcat --strip-components=1</span><br></pre></td></tr></table></figure><ul><li>更改權限<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo useradd -M -s /bin/nologin -d /opt/tomcat tomcat</span><br></pre></td></tr></table></figure><ul><li>加上log<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir /opt/tomcat/Log</span><br></pre></td></tr></table></figure><ul><li>改變所屬群組<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chown -R tomcat:users /opt/tomcat</span><br></pre></td></tr></table></figure><ul><li>編輯tomcat.service檔<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/systemd/system/tomcat.service</span><br></pre></td></tr></table></figure><ul><li>JAVA_HOME要符合java安裝路徑<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Apache Tomcat Web Application Container</span><br><span class="line">After=network.target</span><br><span class="line"> </span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line"> </span><br><span class="line">Environment=JAVA_HOME=/usr/lib64/jvm/jre-1.8.0-openjdk/bin</span><br><span class="line">Environment=CATALINA_PID=/opt/tomcat/temp/tomcat.pid</span><br><span class="line">Environment=CATALINA_HOME=/opt/tomcat</span><br><span class="line">Environment=CATALINA_BASE=/opt/tomcat</span><br><span class="line">Environment=<span class="string">'CATALINA_OPTS=-Xms512M -Xmx8192M -server -XX:+UseParallelGC'</span></span><br><span class="line">Environment=<span class="string">'JAVA_OPTS=-Djava.awt.headless=true -Djava.security.egd=file:/dev/./urandom -Dfile.encoding=UTF8'</span></span><br><span class="line"> </span><br><span class="line">ExecStart=/opt/tomcat/bin/startup.sh</span><br><span class="line">ExecStop=/opt/tomcat/bin/shutdown.sh</span><br><span class="line"> </span><br><span class="line">User=tomcat</span><br><span class="line">Group=users</span><br><span class="line">RestartSec=10</span><br><span class="line">Restart=always</span><br><span class="line"> </span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><h1 id="設定開機啟動"><a href="#設定開機啟動" class="headerlink" title="設定開機啟動"></a>設定開機啟動</h1><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">enable</span> tomcat</span><br></pre></td></tr></table></figure><h1 id="重讀service腳"><a href="#重讀service腳" class="headerlink" title="重讀service腳"></a>重讀service腳</h1><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload</span><br></pre></td></tr></table></figure><h1 id="啟動tomcat"><a href="#啟動tomcat" class="headerlink" title="啟動tomcat"></a>啟動tomcat</h1><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start tomcat</span><br></pre></td></tr></table></figure><h1 id="確認tomcat"><a href="#確認tomcat" class="headerlink" title="確認tomcat"></a>確認tomcat</h1><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status tomcat</span><br></pre></td></tr></table></figure><h1 id="同樣的安裝指令安裝起來的Java版本不同"><a href="#同樣的安裝指令安裝起來的Java版本不同" class="headerlink" title="同樣的安裝指令安裝起來的Java版本不同"></a>同樣的安裝指令安裝起來的Java版本不同</h1><p>去客戶那邊安裝時，測試環境我安裝起來是1.8.0_252，客戶自行安裝的java版本卻變成1.8.0_202，猜測可能是OpenSuse跟Suse的repository不一樣，故採用直接手動安裝的方式</p><ol><li>使用<a href="https://adoptopenjdk.net/releases.html?variant=openjdk8&jvmVariant=hotspot" target="_blank" rel="noopener">AdoptOpenJDK</a></li><li>選擇欲安裝的版本與系統，把.tar.gz檔案載下來</li><li>scp 方式丟上遠端server</li><li>cp 到預安裝的路徑，並解壓縮<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo tar xvf /usr/lib64/java/OpenJDK8U-jre_x64_linux_hotspot_8u252b09.tar.gz -C /usr/lib64/java --strip-components=1</span><br></pre></td></tr></table></figure><ol start="5"><li>設定環境變數<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim /etc/profile</span><br><span class="line"><span class="comment">#最後一行加入</span></span><br><span class="line"><span class="comment">#set java info</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/lib64/java</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="string">"<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$PATH</span>"</span></span><br></pre></td></tr></table></figure><p>6.reload /etc/profile</p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ . /etc/profile</span><br></pre></td></tr></table></figure><ol start="7"><li>檢查java版本<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ java -version</span><br><span class="line">openjdk version <span class="string">"1.8.0_252"</span></span><br><span class="line">OpenJDK Runtime Environment (AdoptOpenJDK)(build 1.8.0_252-b09)</span><br><span class="line">OpenJDK 64-Bit Server VM (AdoptOpenJDK)(build 25.252-b09, mixed mode)</span><br></pre></td></tr></table></figure><ol start="8"><li>將Tomcat中的java路徑更改後暫停再重啟，確認CGroup的啟動路徑已經改為設定的環境變數<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim /etc/systemd/system/tomcat.service</span><br><span class="line">$ sudo systemctl <span class="built_in">enable</span> tomcat</span><br><span class="line">$ sudo systemctl daemon-reload</span><br><span class="line">$ sudo systemctl start tomcat</span><br><span class="line">$ sudo systemctl status tomcat</span><br><span class="line">tomcat.service - Apache Tomcat Web Application Container</span><br><span class="line">   Loaded: loaded (/etc/systemd/system/tomcat.service; enabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since 三 2020-06-17 13:58:34 CST; 23min ago</span><br><span class="line">  Process: 14578 ExecStop=/opt/tomcat/bin/shutdown.sh (code=exited, status=0/SUCCESS)</span><br><span class="line">  Process: 14628 ExecStart=/opt/tomcat/bin/startup.sh (code=exited, status=0/SUCCESS)</span><br><span class="line"> Main PID: 14635 (java)</span><br><span class="line">    Tasks: 31 (<span class="built_in">limit</span>: 512)</span><br><span class="line">   CGroup: /system.slice/tomcat.service</span><br><span class="line">           └─14635 /usr/lib64/java/bin/java -Djava.util.logging.config.file=/opt/tomcat/conf/logging.properties -Dja...</span><br><span class="line"></span><br><span class="line"> 6月 17 13:58:34 linux-g5k0 systemd[1]: Starting Apache Tomcat Web Application Container...</span><br><span class="line"> 6月 17 13:58:34 linux-g5k0 startup.sh[14628]: Tomcat started.</span><br><span class="line"> 6月 17 13:58:34 linux-g5k0 systemd[1]: Started Apache Tomcat Web Application Container.</span><br></pre></td></tr></table></figure><h1 id="Nginx如何設置才讀到到畫面"><a href="#Nginx如何設置才讀到到畫面" class="headerlink" title="Nginx如何設置才讀到到畫面"></a>Nginx如何設置才讀到到畫面</h1><p>加入nginx repository</p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo zypper addrepo -G -t yum -c <span class="string">'http://nginx.org/packages/sles/12'</span> nginx</span><br></pre></td></tr></table></figure><p>更新 repository</p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zypper refresh</span><br></pre></td></tr></table></figure><p>安裝 nginx</p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zypper install nginx</span><br></pre></td></tr></table></figure><p>編輯default.conf檔</p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/nginx/conf.d/</span><br><span class="line"><span class="comment">#備份default.conf</span></span><br><span class="line">cp /etc/nginx/conf.d/default.conf /etc/nginx/conf.d/default.conf_bk</span><br><span class="line"><span class="comment">#編輯default.conf</span></span><br><span class="line">vi /etc/nginx/conf.d/default.conf</span><br></pre></td></tr></table></figure><hr><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        location /yourPath &#123;</span><br><span class="line">            root   /usr/share/nginx;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">            try_files <span class="variable">$uri</span> <span class="variable">$uri</span>/ /yourPath/index.html;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="前端畫面call後端發生CORS問題"><a href="#前端畫面call後端發生CORS問題" class="headerlink" title="前端畫面call後端發生CORS問題"></a>前端畫面call後端發生CORS問題</h1><p>call後端一直call不到，browser一直顯示    </p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Request header field Access-Control-Allow-Headers is not allowed by Access-Control-Allow-Headers <span class="keyword">in</span> preflight response</span><br></pre></td></tr></table></figure><p>而且看了NetWork的地方同一request竟然call了兩次，一次是以http Method Option去call，一次是以原本的post去call，但是請求失敗，上網了解後原來是因為某些條件觸發了預檢請求(Option)，先確認說server可以接受什麼樣的request，所以去檢查是不是有沒有對起來的地方，發現我server接受的Access-Control-Request-Headers: 沒有authorization，於是我在後端程式加入authorization就好了 </p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Allow-Headers: X-requested-with, Content-Type</span><br><span class="line">Access-Control-Allow-Methods: POST, GET, PUT, OPTIONS, DELETE</span><br><span class="line">Access-Control-Allow-Origin: *</span><br><span class="line">Access-Control-Max-Age: 3600</span><br><span class="line">Allow: GET, HEAD, POST, PUT, DELETE, OPTIONS, PATCH</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Length: 0</span><br><span class="line">Date: Fri, 12 Jun 2020 02:37:43 GMT</span><br><span class="line">Keep-Alive: timeout=20</span><br><span class="line"></span><br><span class="line">Request Headers view <span class="built_in">source</span></span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-TW, zh; q=0.9,en-US; q=0.8,en; q=0.7, zh-CN; q=0.6 </span><br><span class="line">Access-Control-Request-Headers: authorization, content-type</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CORSFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest req, ServletResponse res, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        HttpServletResponse response = (HttpServletResponse) res;</span><br><span class="line">        HttpServletRequest request = (HttpServletRequest) req;</span><br><span class="line">        request.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        response.setHeader(<span class="string">"Access-Control-Allow-Origin"</span>, <span class="string">"*"</span>);</span><br><span class="line">        response.setHeader(<span class="string">"Access-Control-Allow-Methods"</span>, <span class="string">"POST, GET, PUT, OPTIONS, DELETE"</span>);</span><br><span class="line">        response.setHeader(<span class="string">"Access-Control-Max-Age"</span>, <span class="string">"3600"</span>);</span><br><span class="line">        response.setHeader(<span class="string">"Access-Control-Allow-Headers"</span>, <span class="string">"X-requested-with, Content-Type, authorization"</span>);</span><br><span class="line">        chain.doFilter(req, res);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://developer.mozilla.org/zh-TW/docs/Web/HTTP/CORS" target="_blank" rel="noopener">跨來源資源共用（CORS）</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;這篇要介紹在 OpenSUSE 上安裝Nginx、Java、Tomcat，並將前端畫面放置在Nginx，後端放置在Tomcat中，當中碰到小卡關的地方&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;安裝軟體時，會有儲存庫缺失問題，需要加入儲存庫&lt;/li&gt;
&lt;li&gt;Tomcat因為Java安裝路徑不對，無法啟動&lt;/li&gt;
&lt;li&gt;同樣的安裝指令安裝起來的Java版本不同&lt;/li&gt;
&lt;li&gt;Nginx如何設置才讀到到畫面&lt;/li&gt;
&lt;li&gt;前端畫面call後端發生CORS問題&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
    
      <category term="Project_Solution" scheme="https://p2626k.github.io/categories/Project-Solution/"/>
    
    
  </entry>
  
  <entry>
    <title>OKHttp-leaked</title>
    <link href="https://p2626k.github.io/2020/06/12/OKHttp-leaked/"/>
    <id>https://p2626k.github.io/2020/06/12/OKHttp-leaked/</id>
    <published>2020-06-12T06:17:29.000Z</published>
    <updated>2020-06-12T08:28:29.675Z</updated>
    
    <content type="html"><![CDATA[<p>使用OKHttp 3時，一直收到Leaked 的警告，上網了解後才發現需要關閉流，以下為錯誤造成的原因，以及修正的方法 </p><a id="more"></a> <p>你將發現Eclipse一直提醒</p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">六月 <span class="number">08</span>, <span class="number">2020</span> <span class="number">9</span>:<span class="number">20</span>:<span class="number">45</span> 上午 okhttp3.internal.platform.Platform <span class="keyword">log</span></span><br><span class="line">警告: A <span class="keyword">connection</span> <span class="keyword">to</span> http://                         / was leaked. Did you forget <span class="keyword">to</span> <span class="keyword">close</span> a response body? <span class="keyword">To</span> see <span class="keyword">where</span> this was allocated, <span class="keyword">set</span> the OkHttpClient logger <span class="keyword">level</span> <span class="keyword">to</span> FINE: Logger.getLogger(OkHttpClient.<span class="keyword">class</span>.getName()).setLevel(<span class="keyword">Level</span>.FINE);</span><br></pre></td></tr></table></figure><p>以下為錯誤寫法 </p><p class="code-caption" data-lang="java" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> String <span class="title">sendECPost</span><span class="params">(String requestUrl, String data)</span> <span class="keyword">throws</span> ServerUnableException </span>&#123;</span><br><span class="line">        String conyentType = Constants.CONTENT_TYPE_JSON;</span><br><span class="line">        log.info(<span class="string">"conyentType :"</span> + conyentType);</span><br><span class="line"></span><br><span class="line">        OkHttpClient client = <span class="keyword">new</span> OkHttpClient().newBuilder().sslSocketFactory(createSSLSocketFactory())</span><br><span class="line">                .hostnameVerifier(<span class="keyword">new</span> HostnameVerifier() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">verify</span><span class="params">(String hostname, SSLSession session)</span> </span>&#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;).build();</span><br><span class="line"></span><br><span class="line">        MediaType mediaType = MediaType.parse(conyentType);</span><br><span class="line">        okhttp3.RequestBody requestBody = okhttp3.RequestBody.create(mediaType, data);</span><br><span class="line">        Request request = <span class="keyword">new</span> Request.Builder().url(requestUrl).post(requestBody).build();</span><br><span class="line">        String responseStr = <span class="keyword">null</span>;</span><br><span class="line">        Call call = client.newCall(request);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Response response = call.execute();</span><br><span class="line">            log.info(response);</span><br><span class="line">            <span class="keyword">if</span> (!response.isSuccessful()) &#123;</span><br><span class="line">                log.info(<span class="string">"response error msg: "</span> + response.message());</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> CustomException.ServerUnableException();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                responseStr = response.body().string().replace(<span class="string">"\n"</span>, <span class="string">""</span>);</span><br><span class="line">                response.body().close();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            log.error(e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> responseStr;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>該如何解決這個問題呢？在response code=200也就是正常的狀況下，都會調用.string()來關閉流，但是若不是此情況，將不會關閉，因此造成leaked，那我們只需在非正常狀況下也關掉流即可，程式碼如下：</p><p class="code-caption" data-lang="java" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> String <span class="title">sendECPost</span><span class="params">(String requestUrl, String data)</span> <span class="keyword">throws</span> ServerUnableException </span>&#123;</span><br><span class="line">        String conyentType = Constants.CONTENT_TYPE_JSON;</span><br><span class="line">        log.info(<span class="string">"conyentType :"</span> + conyentType);</span><br><span class="line"></span><br><span class="line">        OkHttpClient client = <span class="keyword">new</span> OkHttpClient().newBuilder().sslSocketFactory(createSSLSocketFactory())</span><br><span class="line">                .hostnameVerifier(<span class="keyword">new</span> HostnameVerifier() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">verify</span><span class="params">(String hostname, SSLSession session)</span> </span>&#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;).build();</span><br><span class="line"></span><br><span class="line">        MediaType mediaType = MediaType.parse(conyentType);</span><br><span class="line">        okhttp3.RequestBody requestBody = okhttp3.RequestBody.create(mediaType, data);</span><br><span class="line">        Request request = <span class="keyword">new</span> Request.Builder().url(requestUrl).post(requestBody).build();</span><br><span class="line">        String responseStr = <span class="keyword">null</span>;</span><br><span class="line">        Call call = client.newCall(request);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Response response = call.execute();</span><br><span class="line">            log.info(response);</span><br><span class="line">            <span class="keyword">if</span> (!response.isSuccessful()) &#123;</span><br><span class="line">                log.info(<span class="string">"response error msg: "</span> + response.message());</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> CustomException.ServerUnableException();</span><br><span class="line">                response.body().close();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                responseStr = response.body().string().replace(<span class="string">"\n"</span>, <span class="string">""</span>);</span><br><span class="line">                response.body().close();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            log.error(e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> responseStr;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://www.it-swarm.dev/zh/java/okhttp%EF%BC%9A%E9%81%BF%E5%85%8D%E6%B3%84%E6%BC%8F%E8%BF%9E%E6%8E%A5%E8%AD%A6%E5%91%8A/825583451/" target="_blank" rel="noopener">OkHttp：避免泄漏连接警告</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;使用OKHttp 3時，一直收到Leaked 的警告，上網了解後才發現需要關閉流，以下為錯誤造成的原因，以及修正的方法 &lt;/p&gt;
    
    </summary>
    
    
      <category term="Project_Solution" scheme="https://p2626k.github.io/categories/Project-Solution/"/>
    
    
  </entry>
  
  <entry>
    <title>apache 線上課程筆記</title>
    <link href="https://p2626k.github.io/2020/05/25/apache-course-note/"/>
    <id>https://p2626k.github.io/2020/05/25/apache-course-note/</id>
    <published>2020-05-25T08:24:20.000Z</published>
    <updated>2020-06-15T00:50:48.587Z</updated>
    
    <content type="html"><![CDATA[<p>僅以此紀錄線上課程 <a href="https://progressbar.tw/courses/13" target="_blank" rel="noopener">Linux雲端伺服器，用AWS暸解Apache與Nginx</a>筆記</p><a id="more"></a><h1 id="安裝Apache2與建立第一個網頁"><a href="#安裝Apache2與建立第一個網頁" class="headerlink" title="安裝Apache2與建立第一個網頁"></a>安裝Apache2與建立第一個網頁</h1><ul><li>指令 netstat -plnt 可以看到監聽的port號 <ul><li>p代表顯示每個網路連接埠是被哪個程式使用</li><li>t代表tcp</li><li>n代表不自動解析 DNS、連接埠名稱與使用者名稱，這樣可以加速 netstat 的執行速度</li><li>l代表列出所有 listening 狀態的連接埠   <blockquote><p>Linux 的 netstat 指令可以用來查詢各種網路相關資訊，檢測各種網路相關的問題。 在 Linux 系統中若要檢查網路相關的問題，netstat是一個很常使用到的指令之一，雖然他只能在本機執行，但是他可以列出非常多很有用的資訊，像 socket、TCP、UDP、IP 與 ethernet 層的各種資訊都可以利用 netstat 來查詢。<br>一般遇到問題時，第一個檢查步驟就是查閱系統記錄檔（log），必要時可以嘗試提升記錄層級（logging level）來獲得更詳盡的資訊。如果 netstat 所提供的資訊不夠時，亦可使用 Wireshark、tshark、tcpdump 或 nmap 等檢測工具。<br>在每個 Linux 系統中預設都會有安裝 netstat，而且他不需要使用管理者權限即可執行，也同時支援 IPv4 與 IPv6，不過不同的 UNIX/Linux 系統可能在參數上會有一些差異，所以如果您寫好的指令要在不同的系統上執行時，可能要稍微注意一下。<br><a href="https://blog.gtwang.org/linux/linux-netstat-command-examples/" target="_blank" rel="noopener"> 使用 Netstat 指令檢測網路的技巧 </a></p></blockquote></li></ul></li><li>安裝Apache會自動監聽80 port<ul><li>指令 <p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install apache2</span><br></pre></td></tr></table></figure><h1 id="改變Ubuntu-監聽port號與初探反向代理"><a href="#改變Ubuntu-監聽port號與初探反向代理" class="headerlink" title="改變Ubuntu 監聽port號與初探反向代理"></a>改變Ubuntu 監聽port號與初探反向代理</h1><ul><li>改變監聽port號可能是因為安全性問題，不想讓其他人任意連接網站或是任意爬蟲<ul><li>可影響檔案為<ul><li>apache2.conf(設定Directory裡的資料夾路徑，管理/var/www/這個資料夾) </li><li>ports.conf(可以直接改port號)</li><li>site-enabled資料夾(影響的是更細節的東西，virtualhost是可以做更細部的調整)</li></ul></li></ul></li><li>反向代理(使用virtual box時)<ol><li>用virtual box時我們會連到自己本機的8800 port(virtual box設定)</li><li>由127.0.0.1:8800轉到virtual box上主機的80 port </li></ol></li></ul><h1 id="ufw防火牆設定"><a href="#ufw防火牆設定" class="headerlink" title="ufw防火牆設定"></a>ufw防火牆設定</h1><ul><li>預設未開啟，開啟後若無特別設定則會關閉所有連入要求</li><li>若要開啟可先查看防火牆狀態，操作如下<ol><li>指令 sudo ufw app list(可得知防火牆現在允許通過的applications) </li><li>指令 sudo ufw app info OpenSSH(確認 OpenSSH 細節)</li><li>指令 sudo ufw allow 22/tcp(允許tcp 協定 22 port access)</li><li>指令 sudo ufw enable(打開防火牆)</li><li>指令 sudo ufw status(查看防火牆狀態)</li><li>指令 sudo ufw status verbose(查看預設狀態，預設allow (incoming), allow (outgoing))</li></ol></li></ul><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ufw app list</span><br><span class="line">Available applications:</span><br><span class="line">  Apache</span><br><span class="line">  Apache Full</span><br><span class="line">  Apache Secure</span><br><span class="line">  CUPS</span><br><span class="line">  OpenSSH</span><br><span class="line"></span><br><span class="line">$ sudo ufw app info OpenSSH</span><br><span class="line">Profile: OpenSSH</span><br><span class="line">Title: Secure shell server, an rshd replacement</span><br><span class="line">Description: OpenSSH is a free implementation of the Secure Shell protocol.</span><br><span class="line"></span><br><span class="line">Port:</span><br><span class="line">  22/tcp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ sudo ufw allow 22/tcp</span><br><span class="line">Rules updated</span><br><span class="line">Rules updated (v6)</span><br><span class="line"></span><br><span class="line">$ sudo ufw status</span><br><span class="line">Status: active</span><br><span class="line"></span><br><span class="line">To                         Action      From</span><br><span class="line">--                         ------      ----</span><br><span class="line">22/tcp                     ALLOW       Anywhere</span><br><span class="line">80/tcp                     ALLOW       Anywhere</span><br><span class="line">443/tcp                    ALLOW       Anywhere</span><br><span class="line">22/tcp (v6)                ALLOW       Anywhere (v6)</span><br><span class="line">80/tcp (v6)                ALLOW       Anywhere (v6)</span><br><span class="line">443/tcp (v6)               ALLOW       Anywhere (v6)</span><br><span class="line"></span><br><span class="line">$ sudo ufw status verbose</span><br><span class="line">Status: active</span><br><span class="line">Logging: on (low)</span><br><span class="line">Default: allow (incoming), allow (outgoing), disabled (routed)</span><br><span class="line">New profiles: skip</span><br><span class="line"></span><br><span class="line">To                         Action      From</span><br><span class="line">--                         ------      ----</span><br><span class="line">22/tcp                     ALLOW IN    Anywhere</span><br><span class="line">80/tcp                     ALLOW IN    Anywhere</span><br><span class="line">443/tcp                    ALLOW IN    Anywhere</span><br><span class="line">22/tcp (v6)                ALLOW IN    Anywhere (v6)</span><br><span class="line">80/tcp (v6)                ALLOW IN    Anywhere (v6)</span><br><span class="line">443/tcp (v6)               ALLOW IN    Anywhere (v6)</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://www.arthurtoday.com/2013/12/ubuntu-ufw-add-firewall-rules.html" target="_blank" rel="noopener">Ubuntu 用 ufw 指令快速啟用和設定防火牆</a> </p></blockquote><h1 id="3種Apache-service的開關方式與它隱含的意思-systemctl-service-apache2"><a href="#3種Apache-service的開關方式與它隱含的意思-systemctl-service-apache2" class="headerlink" title="3種Apache service的開關方式與它隱含的意思(systemctl, service, apache2)"></a>3種Apache service的開關方式與它隱含的意思(systemctl, service, apache2)</h1><ul><li>一般 Linux系統進來時讀的設定檔為/etc/init.d</li><li>3種Apache service的開關方式<ol><li>systemctl<ul><li>開啟sudo systemctl start apache2.service<ul><li>可先查看要開啟的服務清單，sudo systemctl list-unit-files </li></ul></li><li>關閉sudo systemctl stop apache2.service</li><li>查看狀態sudo systemctl status apache2.service</li></ul></li><li>service(通用型給系統使用)<ul><li>開啟sudo service apache2 start</li><li>關閉sudo sudo service apache2 stop</li><li>查看狀態sudo service apache2 status</li></ul></li><li>apache2<ul><li>開啟sudo /etc/init.d/apache2 start</li><li>關閉sudo /etc/init.d/apache2 start stop</li><li>查看狀態sudo /etc/init.d/apache2 status <blockquote><p>三種指令之前其實是有關係的，但要改設定或起服務時要小心，如果沒有改在根源，抑或是用不同的指令起服務跟關閉服務，會造成有些東西有作用有些東西沒作用，需要注意<br>原理：systemctl、service 都會執行 /usr/sbin/apache2裡的 apache2ctl，apache2ctl 會用到apache2  </p></blockquote></li></ul></li></ol></li></ul><h1 id="etc-底下的apache2檔案分佈用途介紹-amp-Apache-conf-詳細介紹-一-amp-Apache-conf-二-如何簡單的搞砸系統安全性-Directory-denied-granted-DocumentRoot"><a href="#etc-底下的apache2檔案分佈用途介紹-amp-Apache-conf-詳細介紹-一-amp-Apache-conf-二-如何簡單的搞砸系統安全性-Directory-denied-granted-DocumentRoot" class="headerlink" title="etc 底下的apache2檔案分佈用途介紹 &amp; Apache.conf 詳細介紹(一) &amp; Apache.conf(二) 如何簡單的搞砸系統安全性 [Directory, denied, granted, DocumentRoot]"></a>etc 底下的apache2檔案分佈用途介紹 &amp; Apache.conf 詳細介紹(一) &amp; Apache.conf(二) 如何簡單的搞砸系統安全性 [Directory, denied, granted, DocumentRoot]</h1><ol><li>apache2.conf<ul><li>載入ports.conf、conf-enabled、mods-enabled、sites-enabled</li><li>設定的內容都是全域性的</li><li>VirtualHost(sites-enabled中設定)就可以達到同一台主機有兩個不同的網站，可以透過不同的DomainName進到不同的網進到不同的網站</li><li>Include &amp; InculudeOptional 的差異是 Include 是不能沒有，InculudeOptional 是沒有也沒關係</li><li>LogFormat 選擇 Log 格式，不同種的格式會在 sites-enabled/000-default.conf 裡查看，CustomLog 的內容 ${APACHE_LOG_DIR}/access.log combind，真實路徑可在 /etc/apache2/envvars 查看</li><li>Directory 設定從apache進來的人可以看到哪些資料夾內容</li></ul></li><li>envvars<ul><li>環境變數、起服務user &amp; group、log file 位置</li></ul></li><li>ports.conf<ul><li>設定監聽port號</li></ul></li><li>conf-enabled<ul><li>其他配置檔，enabled代表會使用的，會去連結available檔</li></ul></li><li>conf-available</li><li>mods-enabled<ul><li>依功能開啟模組</li></ul></li><li>mods-available</li><li>sites-enabled<ul><li>網站功能相關</li></ul></li><li>sites-available</li><li>magic <ul><li>像是enum的概念，可以自行決定數字代表什麼 </li></ul></li></ol><blockquote><p>vim指令 set nu 及顯示行數<br>Linux 指令 top 可以查看目前所有進行中的程序</p></blockquote><h1 id="補充-Option詳解"><a href="#補充-Option詳解" class="headerlink" title="[補充] Option詳解"></a>[補充] Option詳解</h1><ul><li>ALL<ul><li>打開所有權限除了 MultiViews</li></ul></li><li>ExecCGI<ul><li>共同的通訊協定，可以顯示不同符合CGI協定的程式語言檔案</li></ul></li><li>FollowSymLinks<ul><li>通常都會打開，算有點重要，開啟才能看到軟連結項目</li></ul></li><li>Includes<ul><li>動態用法，如果今天html裡還鑲html，現在動態產生html都是直接使用程式語言，一般建議打開Include 也要打開 IncludesNOEXEC，是一個安全性措施，因為Include 可以使用 server IncludesNOEXEC 可以讓執行的指令消失</li></ul></li><li>IncludesNOEXEC</li><li>Indexes<ul><li>若沒有出現 *index.html，就會直接顯示根目錄</li></ul></li><li>MultiViews<ul><li>很常在現行框架被實現，不見得是使用apache來做到這件事，可以在request 上設置一些header的分隔，使之回應你不同的結果</li></ul></li><li>SymLinksIfOwnerMatch<ul><li>如果今天做一個軟連結，他的owner跟檔案的owner是同一個的話，他就會顯示出來，如果不同就不會顯示，會被FollowSymLinks影響，如果FollowSymLinks開啟，無論SymLinksIfOwnerMatch有沒有開啟，檔案都會顯示出來</li></ul></li></ul><blockquote><p><a href="https://httpd.apache.org/docs/2.4/mod/core.html#options" target="_blank" rel="noopener">https://httpd.apache.org/docs/2.4/mod/core.html#options</a>  </p></blockquote><h1 id="利用不同port號架設多重站台-VirtualHost-a2ensite-a2dissite"><a href="#利用不同port號架設多重站台-VirtualHost-a2ensite-a2dissite" class="headerlink" title="利用不同port號架設多重站台(VirtualHost, a2ensite, a2dissite)"></a>利用不同port號架設多重站台(VirtualHost, a2ensite, a2dissite)</h1><ul><li>Directory <ul><li>AllowOverride 是指.htaccess的權限</li></ul></li><li>sites-enabled<ul><li>指令 a2ensite 000-default 將 000-default.conf 從 sites-available 加回 sites-enabled(因為之前課程有刪除)，如果需要刪除可以透過 a2dissite</li><li>需重啟apache</li><li>sites-available 中做更動，建議使用自己的conf cp 000-default改成自己的</li></ul></li><li>記得將ports.conf中多增加一個監聽的port號(同VirtualHost)</li><li>sudo ufw allow 8480/tcp 若有開啟防火牆請允許此port號</li></ul><blockquote><p>virtual host是一種網路技術，可以讓多個主機名稱（host name），在一個單一伺服器（或是一個伺服器組）上運作，而且可以分開支援每個單一的主機名稱。虛擬主機可以執行多個網站或服務的技術。虛擬並非指不存在，而是指空間是由實體的伺服器延伸而來，其硬體系統可以是基於伺服器群，或者單個伺服器。<br>所以簡單來說，它就像是把你的伺服器切成好幾段，分配給你每一個網站的概念。那麼現在就讓我們來看看要如何操作吧。</p></blockquote><blockquote><p><a href="https://blog.hellosanta.com.tw/%E7%B6%B2%E7%AB%99%E8%A8%AD%E8%A8%88/%E5%BE%8C%E7%AB%AF/%E5%9C%A8linux%E8%88%87mac%E4%B8%8B%E7%94%A8apache%E4%BD%BF%E7%94%A8virtual-host" target="_blank" rel="noopener">在linux與mac下用apache使用Virtual host</a></p></blockquote><h1 id="網域網址設定，利用不同網址Domain架設多站台"><a href="#網域網址設定，利用不同網址Domain架設多站台" class="headerlink" title="網域網址設定，利用不同網址Domain架設多站台"></a>網域網址設定，利用不同網址Domain架設多站台</h1><ul><li>先買網址</li><li>cp 000-default.conf demo.XXX.tw.conf</li><li>cp 000-default.conf test.XXX.tw.conf</li><li>進到各自的conf檔案修改 <ul><li>ServerName demo.XXX.tw,test.XXX.tw</li><li>DocumentRoot /var/www/demo(須自行創建，test的部分只需將demo換成test)</li></ul></li><li>改完之後sudo a2ensite demo.XXX.tw.conf </li><li>sudo systemctl reload apache2</li><li>sudo mkdir /var/www/demo(test也要)</li><li>各自建立index.html</li><li>檢查 apache2.conf Directory /var/www有打開 </li><li>sudo systemctl reload apache2</li></ul><h1 id="利用Rewrite-module-把index-html-導向首頁路徑-mod-rewrite"><a href="#利用Rewrite-module-把index-html-導向首頁路徑-mod-rewrite" class="headerlink" title="利用Rewrite module 把index.html 導向首頁路徑(mod_rewrite)"></a>利用Rewrite module 把index.html 導向首頁路徑(mod_rewrite)</h1><ul><li>將需要的html檔準備好</li><li>將 /etc/apache2/sites-available/demo.XXX.tw.conf 中的 RewriteEngine 改成on ，可以看到RewriteRule ^index.html$ /，代表只要是index開頭 html結尾的都導入根目錄</li><li>必須使用IFModule包起來，代表如果符合時，使用的module為mod_rewrite<ul><li>R=301就是導到301，301是永久，302是暫時 </li><li>L是如果已經比對過就不再比對，可以節省效能<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;IFModule mod_rewrite.c&gt;</span><br><span class="line">    RewriteEngine On</span><br><span class="line">    RewriteRule ^/index\.html$ / [R=301,L]</span><br><span class="line">&lt;/IFModule&gt;</span><br></pre></td></tr></table></figure><ul><li>確認mod_rewrite存不存在，不存在要從mods-avaliable 加回 mods-enabled</li><li>sudo systemctl reload apache2</li></ul><h1 id="使用htaccess，RewriteRule在VirtualHost與htaccess之間的陷阱"><a href="#使用htaccess，RewriteRule在VirtualHost與htaccess之間的陷阱" class="headerlink" title="使用htaccess，RewriteRule在VirtualHost與htaccess之間的陷阱"></a>使用htaccess，RewriteRule在VirtualHost與htaccess之間的陷阱</h1><ul><li>.htaccess不需要reload apache</li><li>小心[R=301,L] 不要有空格</li><li>當直接寫在.htaccess時，不需要加根目錄^/index.html$ ，只需寫成^index.html$，若將此寫回/etc/apache2/sites-available/demo.XXX.tw.conf中，則不起作用，原因參考apache2官方文件，如果寫在.htaccess裡面不需要加根目錄，反之則需要，若要讓兩個地方寫法相同，則須在/etc/apache2/sites-available/demo.XXX.tw.conf原本寫的地方外面加上Directory<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;Directory&gt;</span><br><span class="line">    &lt;IFModule mod_rewrite.c&gt;</span><br><span class="line">        RewriteEngine On</span><br><span class="line">        RewriteRule ^/index\.html$ / [R=301,L]</span><br><span class="line">    &lt;/IFModule&gt;</span><br><span class="line">&lt;/Directory&gt;</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://httpd.apache.org/docs/2.4/mod/core.html#allowoverride" target="_blank" rel="noopener">Allowoverride官方文件</a></p></blockquote><h1 id="AllowOverride-與-AllowOverrideList和htaccess的安全性設定"><a href="#AllowOverride-與-AllowOverrideList和htaccess的安全性設定" class="headerlink" title="AllowOverride 與 AllowOverrideList和htaccess的安全性設定"></a>AllowOverride 與 AllowOverrideList和htaccess的安全性設定</h1><ul><li>上篇能運作是因為我們把apache2.conf中，AllowOverride 設為 All，這樣其實不太好因為這樣等於賦予.htaccess太大的權限</li><li>可以直接取消apache2.conf中Directory /var/www的部分，直接到 /etc/apache2/sites-available/demo.XXX.tw.conf 加入 Directory</li></ul><p>/etc/apache2/sites-available/demo.XXX.tw.conf</p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;Directory /var/www&gt;</span><br><span class="line">    Options FollowSymLinks</span><br><span class="line">    AllowOverride FileInfo(因為這個包含了AllowoverrideList中的RewriteEngine、RewriteRule功能)</span><br><span class="line">    AllowoverrideList &lt;IFModule mod_rewrite.c&gt; Deny</span><br><span class="line">    Require all granted</span><br><span class="line">&lt;/Directory&gt;</span><br></pre></td></tr></table></figure><p>.htaccess</p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;IFModule mod_rewrite.c&gt;</span><br><span class="line">    RewriteEngine On</span><br><span class="line">    RewriteRule ^/index\.html$ / [R=301,L]</span><br><span class="line">&lt;/IFModule&gt;</span><br></pre></td></tr></table></figure><h1 id="移動Log檔到個別專案資料夾"><a href="#移動Log檔到個別專案資料夾" class="headerlink" title="移動Log檔到個別專案資料夾"></a>移動Log檔到個別專案資料夾</h1><ul><li>可進/etc/apache2/sites-available/demo.XXX.tw.conf更改<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ErrorLog /var/www/demo/logs/error.log</span><br><span class="line">CustomLog /var/www/demo/logs/access.log combind</span><br></pre></td></tr></table></figure><h1 id="路徑變化前的條件判斷，RewriteCond-與-RewriteBase"><a href="#路徑變化前的條件判斷，RewriteCond-與-RewriteBase" class="headerlink" title="路徑變化前的條件判斷，RewriteCond 與 RewriteBase"></a>路徑變化前的條件判斷，RewriteCond 與 RewriteBase</h1><ul><li>做兩件事，一是若網址搜尋的是不存在的檔案則導到404頁面(404.html)，二是若網址搜尋log目前狀況是可以看到，我們需要將之也導到404頁面<br>.htaccess<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;IFModule mod_rewrite.c&gt;</span><br><span class="line">    RewriteEngine On</span><br><span class="line">    <span class="comment"># 以根目錄為基準找</span></span><br><span class="line">    RewriteBase /</span><br><span class="line">    <span class="comment"># L是斷點的意思，如果符合就中止</span></span><br><span class="line">    RewriteRule ^/index\.html$ / [R=301,L]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 如果找不到post，導向post/404.html 而非原本的404.html</span></span><br><span class="line">    RewriteCond %&#123;REQUEST_FILENAME&#125; /ports/.*</span><br><span class="line">    RewriteCond %&#123;REQUEST_FILENAME&#125; !-f</span><br><span class="line">    RewriteRule ^ /posts/404.html [R=302,L]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 如果找不到首頁，導向首頁</span></span><br><span class="line">    RewriteCond %&#123;REQUEST_FILENAME&#125; !-f</span><br><span class="line">    RewriteCond %&#123;REQUEST_FILENAME&#125; !-d</span><br><span class="line">    RewriteRule ^ index.html [L]</span><br><span class="line"></span><br><span class="line">     <span class="comment"># 如果嘗試看logs，導向404.html</span></span><br><span class="line">     <span class="comment"># 使用302是因為目前404是代表現在not found，不代表以後也not found，使用301會鎖住</span></span><br><span class="line">    RewriteCond %&#123;REQUEST_FILENAME&#125; /logs/.*</span><br><span class="line">    RewriteCond %&#123;REQUEST_FILENAME&#125; !-d</span><br><span class="line">    RewriteRule ^ 404.html [R=302,L]</span><br><span class="line">&lt;/IFModule&gt;</span><br></pre></td></tr></table></figure><h1 id="架設靜態網站於VirtualBox-scp-指令"><a href="#架設靜態網站於VirtualBox-scp-指令" class="headerlink" title="架設靜態網站於VirtualBox(scp 指令)"></a>架設靜態網站於VirtualBox(scp 指令)</h1><ul><li>複製/etc/apache2/sites-available/000-default.conf /etc/apache2/sites-available/progressbar.com.conf</li><li>更改 progressbar.com.conf VirtualHost port號 &lt;VirtualHost *:8666&gt; ， DocumentRoot /var/www/progressbar</li><li>在/var/www中建立 progressbar資料夾，sudo madir progressbar</li><li>更改資料夾使用者群組，sudo chown mercue:mercue progressbar</li><li>回到本機使用scp -r -P 8001 * <a href="mailto:mercue@127.0.0.1">mercue@127.0.0.1</a>:/var/www/progressbar </li><li>開啟防火牆 sudo ufw allow 8666/tcp</li><li>在/etc/apache2/ports.conf 中加入監聽port號，Listen 8666</li><li>在本機 VirtualBox 中設定反向代理</li></ul><h1 id="看懂Chrome-Network-網站速度相關訊息與簡易壓力測試"><a href="#看懂Chrome-Network-網站速度相關訊息與簡易壓力測試" class="headerlink" title="看懂Chrome Network 網站速度相關訊息與簡易壓力測試"></a>看懂Chrome Network 網站速度相關訊息與簡易壓力測試</h1><ul><li>使用檢查，查看NetWork資訊</li><li>最下面一行範例 33 reuest |18.8KB | Finish 12.82s | DOMContent 300 ms | Load 1.23s(整個網站共有33 request ，傳送了18.8KB的資訊，全部的東西都拿到並顯示共花了 12.82s，文字在javascript長出DOM的時間 300 ms，若花費時間太長可能就是server有問題，若 Load 花費時間太長可能就是此網站的圖片同時被太多人access，導致server無法應付)</li><li>測試網站速度MacOS預設就有這個指令，Linux則是安裝Apache後就會有。Windows可以使用VirtualBox裡面的上課用的Linux Console來執行。不要自己電腦訪問自己，這樣速度會太快不準。指令功用是可以幫你建立很多的連線去訪問預測試的網站<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ab -n 10 -c 10 [欲測試網站網址]</span><br></pre></td></tr></table></figure><h1 id="利用github-page實現CDN概念與防止圖床被盜連"><a href="#利用github-page實現CDN概念與防止圖床被盜連" class="headerlink" title="利用github page實現CDN概念與防止圖床被盜連"></a>利用github page實現CDN概念與防止圖床被盜連</h1><ul><li>將圖片都改為github上的圖片</li><li>在progressbar.com.conf(使用的網站) 加上 IfModule<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;IFModule mod_rewrite.c&gt;</span><br><span class="line">    RewriteEngine On</span><br><span class="line">    RewriteCond %&#123;HTTP_REFERER&#125; !^http://progressbar.newbie.tw$ [NC]</span><br><span class="line">    RewriteCond %&#123;HTTP_REFERER&#125; !^http://progressbar.newbie.tw/.*$ [NC]</span><br><span class="line">    RewriteRule .*.(jpg|gif|png) <span class="string">"-"</span> [NC,F]</span><br><span class="line">    <span class="comment"># NC 不管大小寫，F是擋掉的意思，官網說這樣"-"就會變成403</span></span><br><span class="line">    RewriteRule .*.(jpg|gif|png) hater.png [NC,R]</span><br><span class="line">    <span class="comment"># 也可以寫成這樣表示把它轉到hater.png or 404.html</span></span><br><span class="line">&lt;/IFModule&gt;</span><br></pre></td></tr></table></figure><h1 id="module-headers-與防止網站被iframe嵌入"><a href="#module-headers-與防止網站被iframe嵌入" class="headerlink" title="module headers 與防止網站被iframe嵌入"></a>module headers 與防止網站被iframe嵌入</h1><ul><li>到VirtualHost加上<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Header always append X-Frame-Option SAMEORIGIN</span><br></pre></td></tr></table></figure><ul><li>引入module<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo a2enmod headers</span><br></pre></td></tr></table></figure><ul><li>restart apache<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl restart apache2</span><br></pre></td></tr></table></figure><ul><li>若browser有header的功能才有作用，否則圖片還是會顯示</li></ul><h1 id="利用Let’s-Encrypt-安裝HTTPS與SSLProtocol變更"><a href="#利用Let’s-Encrypt-安裝HTTPS與SSLProtocol變更" class="headerlink" title="利用Let’s Encrypt 安裝HTTPS與SSLProtocol變更"></a>利用Let’s Encrypt 安裝HTTPS與SSLProtocol變更</h1><ul><li>進入Let’s Encrypt官網getting start 中的cerbot</li><li>選擇Apache Ubuntu18.04</li><li>往下滑至Install 照著指令進行即可<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get update</span><br><span class="line">$ sudo apt-get install software-properties-common</span><br><span class="line">$ sudo add-apt-repository universe</span><br><span class="line">$ sudo add-apt-repository ppa:certbot/certbot</span><br><span class="line">$ sudo apt-get update</span><br></pre></td></tr></table></figure><ul><li>Install Certbot<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install certbot python3-certbot-apache</span><br></pre></td></tr></table></figure><ul><li>Choose how you’d like to run Certbot，Either get and install your certificates…<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo certbot --apache</span><br></pre></td></tr></table></figure><ul><li>安裝完成之後需將原有網站的圖片檔案http改成https</li><li>將VirtualHost中原本設置為http的地方改為https<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;IFModule mod_rewrite.c&gt;</span><br><span class="line">    RewriteEngine On</span><br><span class="line">    RewriteCond %&#123;HTTP_REFERER&#125; !^https://progressbar.newbie.tw$ [NC]</span><br><span class="line">    RewriteCond %&#123;HTTP_REFERER&#125; !^https://progressbar.newbie.tw/.*$ [NC]</span><br><span class="line">    RewriteRule .*.(jpg|gif|png) <span class="string">"-"</span> [NC,F]</span><br><span class="line">    <span class="comment"># NC 不管大小寫，F是擋掉的意思，官網說這樣"-"就會變成403</span></span><br><span class="line">    RewriteRule .*.(jpg|gif|png) hater.png [NC,R]</span><br><span class="line">    <span class="comment"># 也可以寫成這樣表示把它轉到hater.png or 404.html</span></span><br><span class="line">&lt;/IFModule&gt;</span><br></pre></td></tr></table></figure><ul><li>雖然是免費的但90天就要更新一次不然會過期，詳細方法在下一章節</li><li>若想更改細項內容可以進入VirtualHost中最下方Let’s Encrypt自動加入的檔案，Include /etc/letsencrypt/options-ssl-apache.conf</li></ul><h1 id="crontab使用與Let’s-encrypt自動更新"><a href="#crontab使用與Let’s-encrypt自動更新" class="headerlink" title="crontab使用與Let’s encrypt自動更新"></a>crontab使用與Let’s encrypt自動更新</h1><ul><li>官網有提供一個指令，90天會自動幫你更新<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo certbot renew --dry-run</span><br></pre></td></tr></table></figure><ul><li>因為不可能90天就進來做一次，只要是架設在Linux上面都會使用cronjob工具</li><li>指令crontab -l 檢視目前有沒有任何的工作要做<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ crontab -l</span><br><span class="line">no crontab <span class="keyword">for</span> mercue</span><br></pre></td></tr></table></figure><ul><li>指令crontab -e 可以進行編輯</li><li>選擇vim，找到# m h dom mon dow command，加上以下內容，此範例為每2分鐘做一次<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># m h dom mon dow command</span></span><br><span class="line">  */2 * * * * <span class="built_in">echo</span> <span class="string">"hello"</span> &gt; ~/hello.txt</span><br></pre></td></tr></table></figure><ul><li>使用sudo，設定自動執行，意即每個月不管是哪一天都要執行<p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># m h dom mon dow command</span></span><br><span class="line">  0 0 1 * * certbot renew --dry-run</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://letsencrypt.org/zh-tw/getting-started/#" target="_blank" rel="noopener">Let’s Encrypt官方網站</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;僅以此紀錄線上課程 &lt;a href=&quot;https://progressbar.tw/courses/13&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Linux雲端伺服器，用AWS暸解Apache與Nginx&lt;/a&gt;筆記&lt;/p&gt;
    
    </summary>
    
    
      <category term="Apache" scheme="https://p2626k.github.io/categories/Apache/"/>
    
    
  </entry>
  
  <entry>
    <title>Linux 基礎指令</title>
    <link href="https://p2626k.github.io/2020/05/23/linux-basic/"/>
    <id>https://p2626k.github.io/2020/05/23/linux-basic/</id>
    <published>2020-05-23T07:43:12.000Z</published>
    <updated>2020-06-12T09:06:23.678Z</updated>
    
    <content type="html"><![CDATA[<p>整理一下早上進修的學習內容，最近買了新的線上課程 <a href="https://progressbar.tw/courses/13" target="_blank" rel="noopener">Linux雲端伺服器，用AWS暸解Apache與Nginx</a>，雖然一直都有在使用 Linux ，但為避免有遺漏，針對課程內學習到的新知做一下整理 </p><a id="more"></a> <h1 id="產生空白資料夾、檔案與命名注意事項-mkdir-touch"><a href="#產生空白資料夾、檔案與命名注意事項-mkdir-touch" class="headerlink" title="產生空白資料夾、檔案與命名注意事項(mkdir, touch)"></a>產生空白資料夾、檔案與命名注意事項(mkdir, touch)</h1><h2 id="mkdir"><a href="#mkdir" class="headerlink" title="mkdir"></a>mkdir</h2><p>使用 mkdir 指令建立目錄時，若相同檔名的資料夾已存在，則會出現錯誤訊息，如下</p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir ECRWD</span><br><span class="line">mkdir: ECRWD: File exists</span><br></pre></td></tr></table></figure><p>一般在 excute shell script 時，若發生此狀況可能造成執行暫停的狀況，如需避免此問題，可以利用 mkdir -p 參數使『建立資料夾已存在』的情況，不要顯示錯誤訊息，使之繼續執行 </p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir -p  ECRWD</span><br><span class="line">$</span><br></pre></td></tr></table></figure><h1 id="文字輸出檔案與串連-echo-printf-cat"><a href="#文字輸出檔案與串連-echo-printf-cat" class="headerlink" title="文字輸出檔案與串連(echo, printf, cat)"></a>文字輸出檔案與串連(echo, printf, cat)</h1><h2 id="echo"><a href="#echo" class="headerlink" title="echo"></a>echo</h2><p>印出 “hi” </p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">"hi"</span></span><br></pre></td></tr></table></figure><p>若使用 “&gt;” 將 “hi” 輸出到 1.txt 檔案 ，如將 “hi” 改成 “hello”，再執行一次指令， “hello” 將覆蓋 “hi”</p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">"hi"</span> &gt; 1.txt</span><br></pre></td></tr></table></figure><p>若需要接續著寫下去，則可使用 “&gt;&gt;” ，將 “hi” 輸出到 1.txt 檔案 ，如將 “hi” 改成 “hello”，再執行一次指令， 將會出現 </p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">"hi"</span> &gt; 1.txt</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">"hello"</span> &gt;&gt; 1.txt</span><br><span class="line">$ cat 1.txt</span><br><span class="line">hi</span><br><span class="line">hello</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;整理一下早上進修的學習內容，最近買了新的線上課程 &lt;a href=&quot;https://progressbar.tw/courses/13&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Linux雲端伺服器，用AWS暸解Apache與Nginx&lt;/a&gt;，雖然一直都有在使用 Linux ，但為避免有遺漏，針對課程內學習到的新知做一下整理 &lt;/p&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://p2626k.github.io/categories/Linux/"/>
    
    
  </entry>
  
  <entry>
    <title>如何延長 Windows Server 2016/2019 試用版 的適用期</title>
    <link href="https://p2626k.github.io/2020/04/24/trial-period/"/>
    <id>https://p2626k.github.io/2020/04/24/trial-period/</id>
    <published>2020-04-24T05:41:08.000Z</published>
    <updated>2020-04-24T08:06:14.933Z</updated>
    
    <content type="html"><![CDATA[<p>安裝Windows Server 2016/2019試用版，在180天後將會過期，過期後將發生每小時自動關機，解決方式為透過啟動 PowerShell 延長試用天數，最多可以操作六次，也就是延長三年</p><a id="more"></a><p>若您尚未下載，請在此處下載：</p><p><a href="https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2016/" target="_blank" rel="noopener">https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2016/</a></p><p><a href="https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2019/" target="_blank" rel="noopener">https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2019/</a></p><h2 id="確認到期天數"><a href="#確認到期天數" class="headerlink" title="確認到期天數"></a>確認到期天數</h2><h3 id="2種方式確認"><a href="#2種方式確認" class="headerlink" title="2種方式確認"></a>2種方式確認</h3><p>1.使用桌面右下角確認：</p><p><img src="https://raw.githubusercontent.com/p2626k/MyPostImage/master/images/window-server/windows-server-1.png" alt="桌面圖片"></p><p>2.使用 PowerShell 確認：</p><p>  啟動 PowerShell 並運行 slmgr</p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ slmgr -dlv</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/p2626k/MyPostImage/master/images/window-server/windows-server-2.png" alt="PowerShell顯示剩餘日期與次數"></p><h2 id="如何延長期限"><a href="#如何延長期限" class="headerlink" title="如何延長期限"></a>如何延長期限</h2><h3 id="透過-PowerShell-運行-slmgr-rearm-將其延長180天"><a href="#透過-PowerShell-運行-slmgr-rearm-將其延長180天" class="headerlink" title="透過 PowerShell 運行 slmgr -rearm 將其延長180天"></a>透過 PowerShell 運行 slmgr -rearm 將其延長180天</h3><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ slmgr -rearm</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/p2626k/MyPostImage/master/images/window-server/windows-server-3.png" alt="PowerShell運行延長180天"></p><h3 id="重新啟動電腦"><a href="#重新啟動電腦" class="headerlink" title="重新啟動電腦"></a>重新啟動電腦</h3><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Restart-Computer</span><br></pre></td></tr></table></figure><h3 id="重新啟動後，打開-PowerShell-並檢查您的設置"><a href="#重新啟動後，打開-PowerShell-並檢查您的設置" class="headerlink" title="重新啟動後，打開 PowerShell 並檢查您的設置"></a>重新啟動後，打開 PowerShell 並檢查您的設置</h3><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ slmgr -dli</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/p2626k/MyPostImage/master/images/window-server/windows-server-4.png" alt="PowerShell運行結果"></p><table><tr><td bgcolor=#008800>此篇文章僅記錄整理遇到問題的解法</td></tr></table><h2 id="Refernce"><a href="#Refernce" class="headerlink" title="Refernce"></a>Refernce</h2><p>[文章出處]<a href="https://sid-500.com/2017/08/08/windows-server-2016-evaluation-how-to-extend-the-trial-period/" target="_blank" rel="noopener">https://sid-500.com/2017/08/08/windows-server-2016-evaluation-how-to-extend-the-trial-period/</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;安裝Windows Server 2016/2019試用版，在180天後將會過期，過期後將發生每小時自動關機，解決方式為透過啟動 PowerShell 延長試用天數，最多可以操作六次，也就是延長三年&lt;/p&gt;
    
    </summary>
    
    
      <category term="WindowServer" scheme="https://p2626k.github.io/categories/WindowServer/"/>
    
    
  </entry>
  
  <entry>
    <title>Hexo + GitHub pages 初學者全記錄</title>
    <link href="https://p2626k.github.io/2020/04/20/hello-world/"/>
    <id>https://p2626k.github.io/2020/04/20/hello-world/</id>
    <published>2020-04-19T16:00:00.000Z</published>
    <updated>2020-04-28T08:23:10.832Z</updated>
    
    <content type="html"><![CDATA[<p>為什麼要寫這篇介紹？</p><p>成為後端工程師後，碰到不會的問題，都是靠google大神，技術時時進步，有時候遇到問題或精進新的技術後，若沒有即時紀錄下來，經過一段時日後，肯定就是『我不認識你，你不屬於我』～</p><p>決定要做就要馬上動手規劃，目前查到最方便的資源就是Hexo + GitHub Pages，優點是完全免費且快速，也無須考慮HTML、CSS、Server、DB等架站技能。</p><a id="more"></a><h1 id="GitHub-Pages"><a href="#GitHub-Pages" class="headerlink" title="GitHub Pages"></a>GitHub Pages</h1><h2 id="註冊-GitHub-帳號"><a href="#註冊-GitHub-帳號" class="headerlink" title="註冊 GitHub 帳號"></a>註冊 GitHub 帳號</h2><p>GitHub 官網：<a href="https://github.com/" target="_blank" rel="noopener">https://github.com/</a></p><h2 id="建立-Github-Pages"><a href="#建立-Github-Pages" class="headerlink" title="建立 Github Pages"></a>建立 Github Pages</h2><p>申請完 GitHub 帳號，點下畫面中 Start a Project</p><p><img src="https://github.com/p2626k/MyPostImage/blob/master/images/create-hexo/create-hexo-1.png?raw=true" alt="Start a Project"></p><p>接著將專案名稱取名為 username.github.io 並按下最下方的 Create repository</p><p>註： username 指的是你的 GitHub 帳號，在旁邊 Owner 的地方就會顯示你的帳號。例如我的帳號是 asc111，那麼專案名稱就取名為 asc111.github.io。</p><p><img src="https://github.com/p2626k/MyPostImage/blob/master/images/create-hexo/create-hexo-2.png?raw=true" alt="Create repository"></p><p>接著進入專案，到 Settings 頁面</p><p><img src="https://github.com/p2626k/MyPostImage/blob/master/images/create-hexo/create-hexo-3.png?raw=true" alt="Settings"></p><p>頁面往下滑，有個 GitHub Pages 設定，點一下 Choose a theme。</p><p><img src="https://github.com/p2626k/MyPostImage/blob/master/images/create-hexo/create-hexo-4.png?raw=true" alt="Choose a theme"></p><p>開新分頁後，有好幾個樣板供使用者選擇，這裡直接按下 Select theme。(這時候的樣板只是暫時，之後才會部署自己的 Hexo 部落格上來)</p><p><img src="https://github.com/p2626k/MyPostImage/blob/master/images/create-hexo/create-hexo-5.png?raw=true" alt="Select theme"></p><p>最後在網址列輸入 <a href="https://username.github.io/" target="_blank" rel="noopener">https://username.github.io/</a> (username 是自己的 GitHub 帳號)，就能看到自己剛架好的 Github Pages</p><p><img src="https://github.com/p2626k/MyPostImage/blob/master/images/create-hexo/create-hexo-6.png?raw=true" alt="Github Pages by yourself"></p><h1 id="Hexo"><a href="#Hexo" class="headerlink" title="Hexo"></a>Hexo</h1><h2 id="環境配置"><a href="#環境配置" class="headerlink" title="環境配置"></a>環境配置</h2><ul><li>安裝 <a href="https://nodejs.org/en/" target="_blank" rel="noopener">Node.js</a></li><li>安裝 <a href="https://git-scm.com/" target="_blank" rel="noopener">Git</a></li></ul><p>順帶一提，若為Mac使用者，也可用 homebrew 安裝，簡單又快速，做法可以參考這篇<a href="https://www.iamtie.com/2019/04/NodeJS.html" target="_blank" rel="noopener">【程式】透過Homebrew安裝Node.js（Mac）</a></p><h2 id="安裝-Hexo"><a href="#安裝-Hexo" class="headerlink" title="安裝 Hexo"></a>安裝 Hexo</h2><p>確認環境配置都安裝完畢，即可執行下方指令安裝 Hexo</p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g hexo-cli</span><br></pre></td></tr></table></figure><h2 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h2><p>安裝完 Hexo 後，執行下方指令，Hexo 將在指定資料夾 <span style="background-color:lavender;"> &lt; folder &gt; </span>中新建部署所需檔案。</p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ hexo init &lt;folder&gt; //初始化新的 Hexo，會在當前路徑建立一個叫 &lt;folder&gt; 的資料夾，資料夾名稱可以隨意取，例如「myblog」，那麼指令就是 hexo init myblog</span><br><span class="line">$ <span class="built_in">cd</span> &lt;folder&gt;</span><br><span class="line">$ npm install //安裝 Hexo</span><br><span class="line">$ npm install hexo-deployer-git --save  //安裝 git 部署套件</span><br></pre></td></tr></table></figure><h3 id="初始化後的資料夾"><a href="#初始化後的資料夾" class="headerlink" title="初始化後的資料夾"></a>初始化後的資料夾</h3><p>_config.yml：網站 配置 檔案，可以在此配置大部分的設定</p><p>package.json：套件版本控制</p><p>scaffolds：鷹架 資料夾。建立新文章時，會根據 scaffolds 來建立檔案</p><p>source：原始檔案資料夾是放置內容的地方</p><p>themes：主題 資料夾。Hexo 會根據主題來產生靜態檔案</p><h2 id="設定-blog-相關配置"><a href="#設定-blog-相關配置" class="headerlink" title="設定 blog 相關配置"></a>設定 blog 相關配置</h2><p>進入剛剛初始化的資料夾 <span style="background-color:lavender;"> &lt; forlder &gt; </span> ，打開 _config.yml 檔進行配置</p><p><img src="https://github.com/p2626k/MyPostImage/blob/master/images/create-hexo/create-hexo-7.png?raw=true" alt="_config.yml"></p><p>打開 _config.yml 後，修改第 6~12 行資訊，輸入完存檔:</p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">title:</span>   <span class="comment">//輸入部落格標題</span></span><br><span class="line"><span class="symbol">subtitle:</span>  <span class="comment">//輸入副標題</span></span><br><span class="line"><span class="symbol">description:</span>  <span class="comment">//輸入網站描述 </span></span><br><span class="line"><span class="symbol">keywords:</span>  <span class="comment">//輸入網站關鍵字(以逗號隔開)，方便 SEO </span></span><br><span class="line"><span class="symbol">author:</span>   <span class="comment">//輸入姓名或暱稱</span></span><br><span class="line"><span class="symbol">language:</span> zh-TW  <span class="comment">//輸入您所使用的語言</span></span><br><span class="line"><span class="symbol">timezone:</span>  <span class="comment">//留空以使用系統時間</span></span><br></pre></td></tr></table></figure><p>接著第 16 行的地方，url 請換成自己網站的連結 <a href="https://username.github.io/" target="_blank" rel="noopener">https://username.github.io/</a> ，username是自己的 GitHub 帳號:</p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">https:</span><span class="comment">//username.github.io/</span></span><br></pre></td></tr></table></figure><p>設定部署至 GitHub 的資訊</p><p>接著同樣於_config.yml，請輸入以下設定，repo 的 username 改成自己的 GitHub 帳號，所以 repo 的連結架構長這樣： <a href="https://github.com/自己帳號/專案名稱.git" target="_blank" rel="noopener">https://github.com/自己帳號/專案名稱.git</a> ，輸入完一樣記得存檔:</p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">deploy</span>:</span><br><span class="line">  <span class="attribute">type</span>: git</span><br><span class="line">  <span class="attribute">repo</span>: <span class="attribute">https</span>:<span class="comment">//github.com/username/username.github.io.git</span></span><br><span class="line">  <span class="attribute">branch</span>: master</span><br></pre></td></tr></table></figure><h2 id="本地測試"><a href="#本地測試" class="headerlink" title="本地測試"></a>本地測試</h2><h3 id="指令介紹"><a href="#指令介紹" class="headerlink" title="指令介紹"></a>指令介紹</h3><p>1.hexo generate (hexo g) 產生靜態檔案，會在目錄下產生public 資料夾</p><p>2.hexo server (hexo s) 啟動local伺服器，預設是 <a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a></p><p>3.hexo deploy (hexo d) 部署網站（ Ex: github, heroku 等平台 ）</p><h3 id="本地呈現"><a href="#本地呈現" class="headerlink" title="本地呈現"></a>本地呈現</h3><p>執行下方兩行指令，就可以在 <a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a> 查看Blog 。</p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hexo g </span><br><span class="line">$ hexo s</span><br></pre></td></tr></table></figure><p><img src="https://github.com/p2626k/MyPostImage/blob/master/images/create-hexo/create-hexo-8.png?raw=true" alt="local server"></p><p>這樣即生成簡易 Blog </p><h2 id="更換主題"><a href="#更換主題" class="headerlink" title="更換主題"></a>更換主題</h2><p>既然是個人 Blog 當然就要有個人風格啦～，可以到<a href="https://hexo.io/themes/" target="_blank" rel="noopener">這裡</a> 挑選 Hexo 主題 ， Hexo 預設是 landscape ，若非熟手建議使用最多人用的 <a href="https://theme-next.org/" target="_blank" rel="noopener">NexT</a> ，因為有較多更新與維護，也支持更多套件。若真的想用其他的主題，建議看一下最後一次維護的日期，儘量不要選太久以前的。</p><h3 id="安裝NexT"><a href="#安裝NexT" class="headerlink" title="安裝NexT"></a>安裝NexT</h3><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/theme-next/hexo-theme-next.git themes/next</span><br></pre></td></tr></table></figure><p>接著修改網站設定_config.yml</p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">theme: <span class="keyword">next</span></span><br></pre></td></tr></table></figure><p>重新啟動server</p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>執行完畢後，主題就改變囉</p><h3 id="編輯主題-config-yml-配置"><a href="#編輯主題-config-yml-配置" class="headerlink" title="編輯主題 _config.yml 配置"></a>編輯主題 _config.yml 配置</h3><p>Scheme 設定</p><p>在NexT 中有多種Scheme 可選擇，其中的預設主題為Muse。在主題設定theme/next/_config.yml裡找到schema，把註解去掉即可開啟</p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#scheme: Muse</span></span><br><span class="line"><span class="meta">#scheme: Mist</span></span><br><span class="line">scheme: Pisces</span><br><span class="line"><span class="meta">#scheme: Gemini</span></span><br></pre></td></tr></table></figure><p>代碼高亮</p><p>NexT 使用 Tomorrow Theme 當作代碼高亮，共有5款主題可以選擇。 NexT 預設使用的是 normal，可選的值有 normal、night、 night blue、 night bright、 night eighties</p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">highlight_theme:</span> normal</span><br></pre></td></tr></table></figure><p>背景特效</p><p>在主題設定themes/next/_config.yml裡還有另外的動畫效果，要打開就把 canvas 值設定為true。</p><p>開啟社群帳號連結</p><p>在主題設定themes/next/_config.yml中新增社群網路連結，取消註解即可使用。</p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">social</span>:</span><br><span class="line">  #<span class="attribute">GitHub</span>: <span class="attribute">https</span>:<span class="comment">//github.com/yourname || fab fa-github</span></span><br><span class="line">  <span class="number">#E</span><span class="attribute">-Mail</span>: <span class="attribute">mailto</span>:xxx<span class="variable">@gmail</span>.com || fa fa-envelope</span><br><span class="line">  #<span class="attribute">Weibo</span>: <span class="attribute">https</span>:<span class="comment">//weibo.com/yourname || fab fa-weibo</span></span><br><span class="line">  #<span class="attribute">Google</span>: <span class="attribute">https</span>:<span class="comment">//plus.google.com/yourname || fab fa-google</span></span><br><span class="line">  #<span class="attribute">Twitter</span>: <span class="attribute">https</span>:<span class="comment">//twitter.com/yourname || fab fa-twitter</span></span><br><span class="line">  <span class="number">#FB</span> <span class="attribute">Page</span>: <span class="attribute">https</span>:<span class="comment">//www.facebook.com/yourname || fab fa-facebook</span></span><br><span class="line">  #<span class="attribute">StackOverflow</span>: <span class="attribute">https</span>:<span class="comment">//stackoverflow.com/yourname || fab fa-stack-overflow</span></span><br><span class="line">  #<span class="attribute">YouTube</span>: <span class="attribute">https</span>:<span class="comment">//youtube.com/yourname || fab fa-youtube</span></span><br><span class="line">  #<span class="attribute">Instagram</span>: <span class="attribute">https</span>:<span class="comment">//www.instagram.com/yourname || fab fa-instagram</span></span><br><span class="line">  #<span class="attribute">Skype</span>: <span class="attribute">skype</span>:yourname?call|chat || fab fa-skype</span><br></pre></td></tr></table></figure><p>RSS</p><p>安裝feed插件</p><p>本地hexo目录下运行<span style="background-color:lavender;color: red"> git bash here </span><br>输入指令<span style="background-color:lavender;color: red"> npm install hexo-generator-feed</span><br>等待安装完成  </p><p>添加配置文件</p><p>打开hexo目录下配置文件_config.yml，末尾添加以下配置</p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># Extensions</span></span><br><span class="line"><span class="meta">## Plugins: http:<span class="comment">//hexo.io/plugins/</span></span></span><br><span class="line"><span class="meta">#RSS订阅</span></span><br><span class="line"><span class="symbol">plugin:</span></span><br><span class="line">- hexo-generator-feed</span><br><span class="line"><span class="meta">#Feed Atom</span></span><br><span class="line"><span class="symbol">feed:</span></span><br><span class="line"><span class="symbol">type:</span> atom</span><br><span class="line"><span class="symbol">path:</span> atom.xml</span><br><span class="line"><span class="symbol">limit:</span> <span class="number">20</span></span><br></pre></td></tr></table></figure><p>打開主題配置文件_config.yml,搜索rss，添加配置<br>rss: /atom.xml</p><p>參考</p><blockquote><p><a href="https://blog.csdn.net/Coder_Jeremy/java/article/details/83588604" target="_blank" rel="noopener">如何给Hexo正确添加RSS订阅</a></p></blockquote><p>Gitalk → 打開留言功能</p><p>1.建立 GitHub OAuth APP</p><p>要使用 Gitalk 必須有 GitHub OAuth，所以首先先開啟 GitHub → Setting</p><p><img src="https://github.com/p2626k/MyPostImage/blob/master/images/create-hexo/create-hexo-9.png?raw=true" alt="Setting"><br>接下來選擇 Developer settings</p><p><img src="https://github.com/p2626k/MyPostImage/blob/master/images/create-hexo/create-hexo-11.png?raw=true" alt="Developer settings"><br>然後點 OAuth Apps 再點上方 New OAuth App<br><img src="https://github.com/p2626k/MyPostImage/blob/master/images/create-hexo/create-hexo-12.png?raw=true" alt="OAuth Apps"><br>接下來依照欄位填寫即可</p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Application</span> <span class="string">name - 應用程式名稱</span></span><br><span class="line"><span class="attr">Homepage</span> <span class="string">URL - 應用程式網域 → 填你部落格網址</span></span><br><span class="line"><span class="attr">Application</span> <span class="string">description - 應用程式描述</span></span><br><span class="line"><span class="attr">Authorization</span> <span class="string">callback URL - 授權回應網址 → 填你部落格網址</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/p2626k/MyPostImage/blob/master/images/create-hexo/create-hexo-13.png?raw=true" alt="New OAuth App"><br>申請完之後你就會獲得這兩組 ID (Client ID、Client Secret)，請不要外流，稍後會使用到</p><p><img src="https://github.com/p2626k/MyPostImage/blob/master/images/create-hexo/create-hexo-14.png?raw=true" alt="ID">  </p><p>Gitalk 是一個基於 GitHub 所開發的留言版套件， 可以使用 MarkDown 格式，所以對於工程師很方便</p><p>2.開啟佈景主題的 _config.yml，然後搜尋「Gitalk」，此時你就可以看到相關設定，只需要依照欄位填入即可(這篇針對主題 Next，若需配合其他主題請再另外找設定的位置)</p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">gitalk:</span><br><span class="line">  enable: <span class="literal">true</span></span><br><span class="line">  github_id:  # GitHub 作者帳號</span><br><span class="line">  repo: xxx.github.io # 你的 Repo 名稱，通常就是網域</span><br><span class="line">  client_id: xxxxxxxx # 剛剛申請的<span class="built_in"> Client </span>ID</span><br><span class="line">  client_secret: xxxxxxxx # 剛剛申請的<span class="built_in"> Client </span>Secret</span><br><span class="line">  admin_user: xxx # 管理者的帳號</span><br><span class="line">  distraction_free_mode: <span class="literal">true</span> # 無干擾模式</span><br><span class="line">  language: zh-TW ## 語系</span><br></pre></td></tr></table></figure><p>3.部署</p><p>請參閱本文 → 部署到 GitHub Pages，部署完畢可以在文章底下看到留言板開啟，一開始需要點選啟用，否則會出現請聯絡 xxx 初始化評論<br><img src="https://github.com/p2626k/MyPostImage/blob/master/images/create-hexo/create-hexo-15.png?raw=true" alt="留言板開啟">  </p><p>參考</p><blockquote><p><a href="https://hsiangfeng.github.io/hexo/20191206/2397475810/" target="_blank" rel="noopener">十分鐘超詳細替 Hexo Next 開啟 Gitalk 留言版</a></p></blockquote><p>添加訪客統計、訪問次數統計、文章閱讀次數統計</p><p>1.打開next主題配置文件\themes\next_config.yml，搜尋找到busuanzi_count，把enable设置为true</p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Show Views / Visitors of the website / page with busuanzi.#展示访问数</span></span><br><span class="line"><span class="comment"># Get more information on http://ibruce.info/2015/04/04/busuanzi</span></span><br><span class="line"><span class="attr">busuanzi_count:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_visitors:</span> <span class="literal">true</span>   <span class="comment">#统计访客数</span></span><br><span class="line">  <span class="attr">total_visitors_icon:</span> <span class="string">user</span></span><br><span class="line">  <span class="attr">total_views:</span> <span class="literal">true</span>    <span class="comment">#统计访问数</span></span><br><span class="line">  <span class="attr">total_views_icon:</span> <span class="string">eye</span></span><br><span class="line">  <span class="attr">post_views:</span> <span class="literal">true</span>   <span class="comment">#统计文章阅读数</span></span><br><span class="line">  <span class="attr">post_views_icon:</span> <span class="string">eye</span></span><br></pre></td></tr></table></figure><p>2.同樣是在next主題配置文件\themes\next_config.yml下，搜尋footer，在它底下添加counter，設值為true</p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#统計</span></span><br><span class="line"><span class="attr">counter:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>3.到themes\next\layout_partials，找到footer.swig文件，打開編輯，在底下添加代码</p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">if</span></span> theme.footer.counter %&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">src</span>=<span class="string">"//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br></pre></td></tr></table></figure><p>4.效果圖：<br>站點訪客數、訪問次數顯示在網站底部</p><p><img src="https://github.com/p2626k/MyPostImage/blob/master/images/create-hexo/create-hexo-16.png?raw=true" alt="訪客數、訪問次數"></p><p>文章閱讀次數在文章開頭</p><p><img src="https://github.com/p2626k/MyPostImage/blob/master/images/create-hexo/create-hexo-17.png?raw=true" alt="文章閱讀次數">  </p><p>參考</p><blockquote><p><a href="https://blog.csdn.net/baidu_34310405/java/article/details/102665373" target="_blank" rel="noopener">Hexo Next主题添加访客统计、访问次数统计、文章阅读次数统计</a></p></blockquote><h2 id="開始動手寫文章"><a href="#開始動手寫文章" class="headerlink" title="開始動手寫文章"></a>開始動手寫文章</h2><h3 id="新建分頁"><a href="#新建分頁" class="headerlink" title="新建分頁"></a>新建分頁</h3><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new page &lt;title&gt;</span><br></pre></td></tr></table></figure><hr><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new page “pageName” <span class="comment"># 新建頁面</span></span><br></pre></td></tr></table></figure><p>所有的文章都會在source/_posts裡面。初始化後就已有一篇範例文章hello-world.md</p><h3 id="新建文章"><a href="#新建文章" class="headerlink" title="新建文章"></a>新建文章</h3><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new [layout] &lt;title&gt;</span><br></pre></td></tr></table></figure><p>如果沒有設定 layout 的話，則會使用 _config.yml 中的 default_layout 設定代替。如果標題包含空格的話，請使用引號括起來</p><p>所以在使用上可以解釋成：</p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new “postName” <span class="comment"># 新建文章</span></span><br></pre></td></tr></table></figure><h3 id="閱讀全文問題"><a href="#閱讀全文問題" class="headerlink" title="閱讀全文問題"></a>閱讀全文問題</h3><p>在首頁會直接出現整篇文章（如下圖）</p><p>如想讓首頁文章折疊，出現Read More，有三種方式，本文使用 Hexo 官網推薦，直接於文章中加入  <span style="background-color:lavender;color: red"> &lt;!– more –&gt; </span>  手動進行截斷</p><p>參考</p><blockquote><p><a href="https://theme-next.iissnan.com/faqs.html#custom-font" target="_blank" rel="noopener">如何设置「阅读全文」？</a></p></blockquote><h3 id="插入圖片"><a href="#插入圖片" class="headerlink" title="插入圖片"></a>插入圖片</h3><p>Markdown中插入圖片的三個技巧<br>Markdown插入圖片有三種方法，各種Markdown編輯器的插圖方式也都包含在這三種方法之内</p><p>插圖最基礎的格式就是：</p><p><span style="background-color:lavender;color: red"> ![Alt text](圖片連結 “optional title”) </span>  </p><blockquote><p>Alt text：圖片的Alt标签，用来描述圖片的關鍵詞，可以不寫。最初的本意是當圖片因爲某種原因不能被顯示時而出線的替代文字，後又被用於SEO，可以方便搜尋引擎根據Alt text里面的關鍵詞搜尋到圖片。</p></blockquote><blockquote><p>图片連結：可以使圖片的本地地址或者是網址。<br>“optional title”：鼠標懸置於圖片上會出现的標題文字，可以不寫。</p></blockquote><p>1.插入本地圖片</p><p>只需要在基礎語法的括號中填入圖片的位置路徑即可，支持绝對路徑和相對路徑</p><p>例如：<span style="background-color:lavender;color: red"> ! [本地圖片](/user/desktop/doge.png) </span>  </p><blockquote><p>缺点是不灵活，不好分享。本地图片的路径更改或丢失都会造成Markdown文件调不出图片</p></blockquote><p>2.插入網路圖片</p><p>只需要在基礎語法的括號中填入圖片的網路連結即可，現在已經有很多免費/收費圖床和方便傳圖的小工具可選</p><p>例如：<span style="background-color:lavender;color: red"> ! [網路圖片](baidu.com/pic/doge.png) </span>  </p><blockquote><p>缺點是圖片存在網路服務器上，非常依賴網路</p></blockquote><p>3.把圖片存入Markdown文件</p><p>用base64轉碼工具把圖片轉成一段字符串，然後把字符串填到基礎格式中連結的位置</p><p>基礎用法：<span style="background-color:lavender;color: red"> ! [圖片存入Markdown文件](data:image/png;base64,iVBORw0……)<br> </span>  </p><p>這時候你會發現，插入的這一長串字符串會把整個文章分割開，非常影響編寫文章時的體驗</p><p>如果能夠把大段的base64字符串放在文章末尾，然後在文章中通過一个id來調用，文章就不會被分割的這麼亂了。就像寫論文時的文末註釋和參考文檔一樣</p><p>這個想法可以通過Markdown的參考式連結語法來實現</p><p>進階用法：</p><p><span style="background-color:lavender;color: red"> ![avatar][doge]</span><br><span style="background-color:lavender;color: red"> [doge]:data:image/png;base64,iVBORw0……</span>  </p><blockquote><p>這個用法不常見，優點是很靈活，不會又連結失敗的問題，缺點是一大團base64</p></blockquote><p><span style="background-color:#FFFF33;color: #886600"> 總結，最後本文使用的為 2.插入網路圖片，但將圖片放在 GitHub 上，一是免費，二是此網站較不會有掛掉的問題，可以參考<a href="https://www.itread01.com/content/1500363499.html" target="_blank" rel="noopener">關於markdown文件插入圖片遇到的小問題和解決辦法</a></span> </p><p>參考</p><blockquote><p><a href="https://blog.csdn.net/m0_37167788/article/details/78809829" target="_blank" rel="noopener">Markdown系列（7）- Markdown中插入图片的三个技巧</a></p></blockquote><h3 id="為文章添加分類"><a href="#為文章添加分類" class="headerlink" title="為文章添加分類"></a>為文章添加分類</h3><p>1.編輯已添之分類頁 (categories)，將頁面的類型設置為 categories ，主題將自動為這個頁面顯示所有分類</p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">分类</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2014</span><span class="number">-12</span><span class="number">-22</span> <span class="number">12</span><span class="string">:39:04</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">"categories"</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><p>2.編輯主題的 _config.yml 檔案，取消 menu categories: /categories 註釋，如下:</p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">menu</span>:</span><br><span class="line">  home: /</span><br><span class="line">  categorie<span class="variable">s:</span> /categories</span><br><span class="line">  archive<span class="variable">s:</span> /archives</span><br><span class="line">  <span class="keyword">tag</span><span class="variable">s:</span> /<span class="keyword">tags</span></span><br></pre></td></tr></table></figure><p>注意：分類中需有文章，始能見效</p><p>添加文章分類關聯</p><p>1.hexo中有Front-matter这个概念，是文件最上方以 — 分隔的区域，用於指定個別文件的變量。例如，在hexo new post article時會生成article.md文件，文件生成好的文章属性。</p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">hexo</span> <span class="string">next</span> <span class="string">分頁</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2016</span><span class="number">-03</span><span class="number">-16</span> <span class="number">08</span><span class="string">:12:43</span></span><br><span class="line"><span class="attr">tags:</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><p>2.在其中添加categories属性，再部署之后就可以在分类页看到分类了</p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">hexo</span> <span class="string">next</span> <span class="string">分頁</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2016</span><span class="number">-03</span><span class="number">-16</span> <span class="number">08</span><span class="string">:12:43</span></span><br><span class="line"><span class="attr">tags:</span></span><br><span class="line"><span class="attr">categories:</span> <span class="string">hexo</span> <span class="string">使用</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><p>參考</p><blockquote><p><a href="https://whx4j8.github.io/2016/03/16/hexo-next-%E6%B7%BB%E5%8A%A0%E4%B8%BA%E6%96%87%E7%AB%A0%E6%B7%BB%E5%8A%A0%E5%88%86%E7%B1%BB/" target="_blank" rel="noopener">hexo next 为文章添加分类</a></p></blockquote><h2 id="部署到-GitHub-Pages"><a href="#部署到-GitHub-Pages" class="headerlink" title="部署到 GitHub Pages"></a>部署到 GitHub Pages</h2><p>現在文章基礎都差不多囉～可以準備部署到 GitHub Pages</p><p>回到終端機，首先確認終端機的路徑在 <span style="background-color:lavender;"> &lt; folder &gt; </span>中新建部署所需檔案。 資料夾根目錄下，並依序輸入以下三個指令：(輸入 hexo d 後會要求登入 GitHub 帳號)</p><p class="code-caption" data-lang="bash" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="code" data-labels_right=":" data-labels_copy=""><span class="code-caption-label"></span><a class="code-caption-copy"></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ hexo cl  //清除之前建立的靜態檔案，也可以輸入 hexo clean</span><br><span class="line">$ hexo g  //建立靜態檔案，也可以輸入 hexo generate</span><br><span class="line">$ hexo d  //部署至 Github Pages，也可以輸入 hexo deploy</span><br></pre></td></tr></table></figure><p>這樣就把網站自動生成並發佈到 <a href="https://username.github.io" target="_blank" rel="noopener">https://username.github.io</a> 上的指令，訪問此網址即可看到成果～</p><h1 id="參考連結"><a href="#參考連結" class="headerlink" title="參考連結"></a>參考連結</h1><blockquote><p><a href="https://hexo.io/zh-tw/docs/" target="_blank" rel="noopener"> Hexo 官方文件</a></p></blockquote><blockquote><p><a href="https://medium.com/@bebebobohaha/%E4%BD%BF%E7%94%A8-hexo-gitpage-%E6%90%AD%E5%BB%BA%E5%80%8B%E4%BA%BA-blog-5c6ed52f23db" target="_blank" rel="noopener">如何搭建個人 Blog 使用 Hexo + Gitpage</a></p></blockquote><blockquote><p><a href="https://ed521.github.io/2019/07/hexo-install/" target="_blank" rel="noopener">[教學] 使用 GitHub Pages + Hexo 來架設個人部落格</a></p></blockquote><blockquote><p><a href="https://linghucong.js.org/2016/04/15/2016-04-15-hexo-github-pages-blog/" target="_blank" rel="noopener">手把手教你使用Hexo + Github Pages搭建个人独立博客</a></p></blockquote><blockquote><p><a href="https://xiabor.com/2019/12/31/postskill/#%E6%95%88%E6%9E%9C%E6%BC%94%E7%A4%BA" target="_blank" rel="noopener">Hexo写文章的一些小技巧</a></p></blockquote><blockquote><p><a href="http://yearito.cn/posts/hexo-writing-skills.html#Markdown%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95" target="_blank" rel="noopener">Hexo 搭建个人博客系列：写作技巧篇</a></p></blockquote><blockquote><p><a href="https://www.markdownguide.org/extended-syntax#definition-lists" target="_blank" rel="noopener">The Markdown elements outlined in John Gruber’s design document.</a></p></blockquote><blockquote><p><a href="http://xianbai.me/learn-md/index.html" target="_blank" rel="noopener">Learning-Markdown (Markdown 入门参考)</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;為什麼要寫這篇介紹？&lt;/p&gt;
&lt;p&gt;成為後端工程師後，碰到不會的問題，都是靠google大神，技術時時進步，有時候遇到問題或精進新的技術後，若沒有即時紀錄下來，經過一段時日後，肯定就是『我不認識你，你不屬於我』～&lt;/p&gt;
&lt;p&gt;決定要做就要馬上動手規劃，目前查到最方便的資源就是Hexo + GitHub Pages，優點是完全免費且快速，也無須考慮HTML、CSS、Server、DB等架站技能。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Blog" scheme="https://p2626k.github.io/categories/Blog/"/>
    
    
  </entry>
  
</feed>
